"use strict";(self.webpackChunkdendrogram=self.webpackChunkdendrogram||[]).push([[228],{4263:(e,n,t)=>{t.d(n,{A:()=>c});var r=t(3434),o=t.n(r),s=t(6170),i=t.n(s)()(o());i.push([e.id,".src-components-viewer-dendrogram-viewer-dendrogram-module_viewerDendrogram_ujE4Oo {\n  canvas {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n  }\n}\n","",{version:3,sources:["webpack://./src/components/viewer-dendrogram/viewer-dendrogram.module.css"],names:[],mappings:"AAAA;EACE;IACE,kBAAkB;IAClB,OAAO;IACP,MAAM;IACN,WAAW;IACX,YAAY;EACd;AACF",sourcesContent:[".viewerDendrogram {\n  canvas {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n  }\n}\n"],sourceRoot:""}]),i.locals={viewerDendrogram:"src-components-viewer-dendrogram-viewer-dendrogram-module_viewerDendrogram_ujE4Oo"};const c=i},9228:(e,n,t)=>{t.r(n),t.d(n,{default:()=>W});var r=t(5656),o=t(7140);function s(e){var n;const t=[],r=new Map;for(const o of Object.keys(e)){const s=e[o],i=s.nseg-1,c=`${s.xend[i]}/${s.yend[i]}/${s.zend[i]}`,l=`${s.xstart[0]}/${s.ystart[0]}/${s.zstart[0]}`,a={section:s,level:0,rank:0,x:0,y:0,children:[]};r.set(c,a.children),(null!=(n=r.get(l))?n:t).push(a)}const o=[];return i(t,o,0),{children:t,levels:o}}function i(e,n,t){for(;n.length<=t;)n.push(0);const r=n[t];for(let o=0;o<e.length;o++){const s=e[o];s.rank=r+o,s.level=t,i(s.children,n,t+1)}n[t]=r+e.length}class c{constructor(){this._morphology={},this.context=null,this.paintingScheduled=!1,this.segments={},this.init=e=>{if(!e)return;const n=e.getContext("2d");return this.context=n,this.observer.observe(e),this.updateMorphology(),this.delete},this.paint=()=>{this.paintingScheduled||(this.paintingScheduled=!0,globalThis.requestAnimationFrame(this.actualPaint))},this.actualPaint=()=>{this.paintingScheduled=!1;const{context:e}=this;if(!e)return;const{canvas:n}=e;!function(e){e.width===e.clientWidth&&e.height===e.clientHeight||(e.width=e.clientWidth,e.height=e.clientHeight)}(n);const{width:t,height:r}=n;e.fillStyle="#000",e.fillRect(0,0,t,r);const o=t-16,s=r-16,i=e=>.5+Math.round(8+o*e),c=e=>.5+Math.round(8+s*e);e.lineWidth=2;for(const n of Object.keys(this.segments)){e.strokeStyle=n,e.beginPath();for(const{x0:t,y0:r,x1:o,y1:s}of this.segments[n])e.moveTo(i(t),c(r)),e.lineTo(i(o),c(s));e.stroke()}},this.delete=()=>{const{context:e}=this;e&&(this.observer.unobserve(e.canvas),this.context=null)},this.observer=new ResizeObserver(this.paint)}get morphology(){return this._morphology}set morphology(e){e!==this._morphology&&(this._morphology=e,this.updateMorphology())}updateMorphology(){const{context:e}=this;if(!e)return;const n=s(this.morphology);console.log("ðŸž [painter@94] tree =",n);const t={};l(t,n.children,n.levels),console.log("ðŸž [painter@97] segments =",t),this.segments=t,this.paint()}}function l(e,n,t){for(const r of n){l(e,r.children,t);const n=h(e,a(r.section.name));for(const{rank:e,level:o}of r.children){const r=(e+.5)/t[o],s=o/t.length,i=1/t.length;n.push({x0:r,y0:s,x1:r,y1:s+i})}}if(n.length>1){const[r]=n,o=n[n.length-1],s=h(e,a("horizontal")),i=(r.rank+.5)/t[r.level],c=(o.rank+.5)/t[o.level],l=r.level/t.length;s.push({x0:i,y0:l,x1:c,y1:l})}}function a(e){switch(e.slice(0,4).toLocaleLowerCase()){case"axon":return"#07f";case"dend":return"#F55";case"basa":return"#F33";case"apic":return"#F8f";case"myel":return"#778";case"soma":return"#dde";case"horizontal":return"#7f75";default:return"#fff"}}function h(e,n){const t=e[n];if(t)return t;const r=[];return e[n]=r,r}var d=t(7229);function u(...e){return d.Sxu.classNames.join(...e)}var g=t(430),m=t.n(g),f=t(3783),p=t.n(f),v=t(6077),y=t.n(v),A=t(3406),x=t.n(A),b=t(9162),w=t.n(b),k=t(9839),C=t.n(k),O=t(4263),j={};j.styleTagTransform=C(),j.setAttributes=x(),j.insert=y().bind(null,"head"),j.domAPI=p(),j.insertStyleElement=w(),m()(O.A,j);const E=O.A&&O.A.locals?O.A.locals:void 0;function S({className:e,morphology:n}){const t=function(e){const n=o.useRef(null);return n.current||(n.current=new c),o.useEffect(()=>{const t=n.current;t&&(t.morphology=e)},[e]),n.current}(n);return(0,r.jsx)("div",{className:u(e,E.viewerDendrogram),children:(0,r.jsx)("canvas",{ref:t.init})})}var M=Object.defineProperty,P=Object.getOwnPropertySymbols,$=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,z=(e,n,t)=>n in e?M(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;const I=function(){const e={};return function(e,n){F(e),T(n,e)}([D({children:[D({name:"dend.1",children:[D({name:"dend.1.1"}),D({name:"dend.1.2"})]}),D({name:"dend.2",children:[D({name:"dend.2.1"}),D({name:"dend.2.2"}),D({name:"dend.2.3"})]})]})],e),e}();function D(e){return((e,n)=>{for(var t in n||(n={}))$.call(n,t)&&z(e,t,n[t]);if(P)for(var t of P(n))_.call(n,t)&&z(e,t,n[t]);return e})({name:"soma",x:0,y:0,children:[]},e)}function F(e,n=0,t=0){for(const r of e)n+=F(r.children,t+1),r.x=n++,r.y=t;return n}function T(e,n,t={name:"",children:[],x:0,y:0},r=0){for(const o of n){const n=`${o.name}/${r++}`;e[n]={name:n,nseg:1,xstart:[t.x],ystart:[t.y],zstart:[0],xend:[o.x],yend:[o.y],zend:[0]},r=T(e,o.children,o,r)}return r}function W(){return(0,r.jsx)(S,{morphology:I})}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixLQUFNLGFBQ1YyQixFQUFFLENBQUUzQixLQUFNLGFBQ1YyQixFQUFFLENBQUUzQixLQUFNLG9CQU05QmpGLEdBRUdBLENBQ1gsQ0E5Q3NDNkcsR0FTdEMsU0FBU0QsRUFBRTFGLEdBQ1AsTSxtSEFBTyxFQUNIK0QsS0FBTSxPQUNONUQsRUFBRyxFQUNIQyxFQUFHLEVBQ0hyQixTQUFVLElBQ1BpQixFQUVYLENBeUNBLFNBQVN1RixFQUFjL0IsRUFBa0J0RCxFQUFPLEVBQUdELEVBQVEsR0FDdkQsVUFBV0QsS0FBUXdELEVBQ2Z0RCxHQUFRcUYsRUFBY3ZGLEVBQUtqQixTQUFVa0IsRUFBUSxHQUM3Q0QsRUFBS0csRUFBSUQsSUFDVEYsRUFBS0ksRUFBSUgsRUFFYixPQUFPQyxDQUNYLENBRUEsU0FBU3NGLEVBQ0wxRyxFQUNBMEUsRUFDQW9DLEVBQW1CLENBQUU3QixLQUFNLEdBQUloRixTQUFVLEdBQUlvQixFQUFHLEVBQUdDLEVBQUcsR0FDdER6QixFQUFLLEdBRUwsVUFBV3FCLEtBQVF3RCxFQUFNLENBQ3JCLE1BQU1PLEVBQU8sR0FBRy9ELEVBQUsrRCxRQUFRcEYsTUFDN0JHLEVBQVdpRixHQUFRLENBQ2ZBLE9BQ0F4RSxLQUFNLEVBQ05NLE9BQVEsQ0FBQytGLEVBQU96RixHQUNoQkwsT0FBUSxDQUFDOEYsRUFBT3hGLEdBQ2hCTCxPQUFRLENBQUMsR0FDVE4sS0FBTSxDQUFDTyxFQUFLRyxHQUNaVCxLQUFNLENBQUNNLEVBQUtJLEdBQ1pULEtBQU0sQ0FBQyxJQUVYaEIsRUFBSzZHLEVBQW1CMUcsRUFBWWtCLEVBQUtqQixTQUFVaUIsRUFBTXJCLEVBQzdELENBQ0EsT0FBT0EsQ0FDWCxDQ3ZGZSxTQUFTa0gsSUFDcEIsT0FBTyxTQUFDYixFQUFnQixDQUFDbEcsV0FBVSxHQUN2QyxDIiwic291cmNlcyI6WyIvaG9tZS90b2xva29iYW4vQ29kZS9naXRodWIvc3R1ZGllcy9kZW5kcm9ncmFtL3NyYy9jb21wb25lbnRzL3ZpZXdlci1kZW5kcm9ncmFtL3ZpZXdlci1kZW5kcm9ncmFtLm1vZHVsZS5jc3MiLCIvaG9tZS90b2xva29iYW4vQ29kZS9naXRodWIvc3R1ZGllcy9kZW5kcm9ncmFtL3NyYy9jb21wb25lbnRzL3ZpZXdlci1kZW5kcm9ncmFtL3BhaW50ZXIvdHJlZS50cyIsIi9ob21lL3RvbG9rb2Jhbi9Db2RlL2dpdGh1Yi9zdHVkaWVzL2RlbmRyb2dyYW0vc3JjL2NvbXBvbmVudHMvdmlld2VyLWRlbmRyb2dyYW0vcGFpbnRlci9wYWludGVyLnRzIiwiL2hvbWUvdG9sb2tvYmFuL0NvZGUvZ2l0aHViL3N0dWRpZXMvZGVuZHJvZ3JhbS9zcmMvdXRpbC91dGlscy50cyIsIndlYnBhY2s6Ly9kZW5kcm9ncmFtLy4vc3JjL2NvbXBvbmVudHMvdmlld2VyLWRlbmRyb2dyYW0vdmlld2VyLWRlbmRyb2dyYW0ubW9kdWxlLmNzcz8yMzVmIiwiL2hvbWUvdG9sb2tvYmFuL0NvZGUvZ2l0aHViL3N0dWRpZXMvZGVuZHJvZ3JhbS9zcmMvY29tcG9uZW50cy92aWV3ZXItZGVuZHJvZ3JhbS92aWV3ZXItZGVuZHJvZ3JhbS50c3giLCIvaG9tZS90b2xva29iYW4vQ29kZS9naXRodWIvc3R1ZGllcy9kZW5kcm9ncmFtL3NyYy9hcHAvbW9ycGhvbG9neS50cyIsIi9ob21lL3RvbG9rb2Jhbi9Db2RlL2dpdGh1Yi9zdHVkaWVzL2RlbmRyb2dyYW0vc3JjL2FwcC9wYWdlLnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2Nzcy1sb2FkZXJANi4xMS4wX3dlYnBhY2tANS4xMDIuMS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvc291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL2Nzcy1sb2FkZXJANi4xMS4wX3dlYnBhY2tANS4xMDIuMS9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCI7XG52YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyk7XG4vLyBNb2R1bGVcbl9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pZCwgYC5zcmMtY29tcG9uZW50cy12aWV3ZXItZGVuZHJvZ3JhbS12aWV3ZXItZGVuZHJvZ3JhbS1tb2R1bGVfdmlld2VyRGVuZHJvZ3JhbV91akU0T28ge1xuICBjYW52YXMge1xuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICBsZWZ0OiAwO1xuICAgIHRvcDogMDtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDEwMCU7XG4gIH1cbn1cbmAsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL2NvbXBvbmVudHMvdmlld2VyLWRlbmRyb2dyYW0vdmlld2VyLWRlbmRyb2dyYW0ubW9kdWxlLmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTtFQUNFO0lBQ0Usa0JBQWtCO0lBQ2xCLE9BQU87SUFDUCxNQUFNO0lBQ04sV0FBVztJQUNYLFlBQVk7RUFDZDtBQUNGXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi52aWV3ZXJEZW5kcm9ncmFtIHtcXG4gIGNhbnZhcyB7XFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG4gICAgbGVmdDogMDtcXG4gICAgdG9wOiAwO1xcbiAgICB3aWR0aDogMTAwJTtcXG4gICAgaGVpZ2h0OiAxMDAlO1xcbiAgfVxcbn1cXG5cIl0sXCJzb3VyY2VSb290XCI6XCJcIn1dKTtcbi8vIEV4cG9ydHNcbl9fX0NTU19MT0FERVJfRVhQT1JUX19fLmxvY2FscyA9IHtcblx0XCJ2aWV3ZXJEZW5kcm9ncmFtXCI6IGBzcmMtY29tcG9uZW50cy12aWV3ZXItZGVuZHJvZ3JhbS12aWV3ZXItZGVuZHJvZ3JhbS1tb2R1bGVfdmlld2VyRGVuZHJvZ3JhbV91akU0T29gXG59O1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBuby1wYXJhbS1yZWFzc2lnbiAqL1xuaW1wb3J0IHsgTW9ycGhvbG9neSwgTmV1cm9uU2VjdGlvbkluZm8gfSBmcm9tICdAL3NlcnZpY2VzL2JsdWVuYWFzLXNpbmdsZS1jZWxsL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBUcmVlIHtcbiAgY2hpbGRyZW46IFRyZWVJdGVtW107XG4gIC8vIE51bWJlciBvZiBpdGVtcyBwZXIgbGV2ZWwuXG4gIGxldmVsczogbnVtYmVyW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJlZUl0ZW0ge1xuICBzZWN0aW9uOiBOZXVyb25TZWN0aW9uSW5mbztcbiAgLy8gRGVwdGggbGV2ZWwuIFJvb3QgaXMgMC5cbiAgbGV2ZWw6IG51bWJlcjtcbiAgLy8gSW5kZXggaW4gdGhlIGN1cnJlbnQgbGV2ZWwuXG4gIHJhbms6IG51bWJlcjtcbiAgeDogbnVtYmVyO1xuICB5OiBudW1iZXI7XG4gIGNoaWxkcmVuOiBUcmVlSXRlbVtdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlVHJlZVN0cnVjdHVyZShtb3JwaG9sb2d5OiBNb3JwaG9sb2d5KTogVHJlZSB7XG4gIGNvbnN0IGNoaWxkcmVuOiBUcmVlSXRlbVtdID0gW107XG4gIGNvbnN0IGl0ZW1zID0gbmV3IE1hcDxzdHJpbmcsIFRyZWVJdGVtW10+KCk7XG4gIGZvciAoY29uc3Qgc2VjdGlvbk5hbWUgb2YgT2JqZWN0LmtleXMobW9ycGhvbG9neSkpIHtcbiAgICBjb25zdCBzZWN0aW9uID0gbW9ycGhvbG9neVtzZWN0aW9uTmFtZV07XG4gICAgY29uc3QgaSA9IHNlY3Rpb24ubnNlZyAtIDE7XG4gICAgY29uc3Qga2V5SXRlbSA9IGAke3NlY3Rpb24ueGVuZFtpXX0vJHtzZWN0aW9uLnllbmRbaV19LyR7c2VjdGlvbi56ZW5kW2ldfWA7XG4gICAgY29uc3Qga2V5UGFyZW50ID0gYCR7c2VjdGlvbi54c3RhcnRbMF19LyR7c2VjdGlvbi55c3RhcnRbMF19LyR7c2VjdGlvbi56c3RhcnRbMF19YDtcbiAgICBjb25zdCBpdGVtOiBUcmVlSXRlbSA9IHtcbiAgICAgIHNlY3Rpb24sXG4gICAgICBsZXZlbDogMCxcbiAgICAgIHJhbms6IDAsXG4gICAgICB4OiAwLFxuICAgICAgeTogMCxcbiAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICB9O1xuICAgIGl0ZW1zLnNldChrZXlJdGVtLCBpdGVtLmNoaWxkcmVuKTtcbiAgICBjb25zdCBwYXJlbnQgPSBpdGVtcy5nZXQoa2V5UGFyZW50KSA/PyBjaGlsZHJlbjtcbiAgICBwYXJlbnQucHVzaChpdGVtKTtcbiAgfVxuICBjb25zdCBsZXZlbHM6IG51bWJlcltdID0gW107XG4gIGNvbXB1dGVSYW5rc0FuZExldmVscyhjaGlsZHJlbiwgbGV2ZWxzLCAwKTtcbiAgcmV0dXJuIHsgY2hpbGRyZW4sIGxldmVscyB9O1xufVxuXG5mdW5jdGlvbiBjb21wdXRlUmFua3NBbmRMZXZlbHMoY2hpbGRyZW46IFRyZWVJdGVtW10sIGxldmVsczogbnVtYmVyW10sIGxldmVsOiBudW1iZXIpIHtcbiAgd2hpbGUgKGxldmVscy5sZW5ndGggPD0gbGV2ZWwpIGxldmVscy5wdXNoKDApO1xuICBjb25zdCBtaW5SYW5rID0gbGV2ZWxzW2xldmVsXTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgIGNvbnN0IGl0ZW0gPSBjaGlsZHJlbltpXTtcbiAgICBpdGVtLnJhbmsgPSBtaW5SYW5rICsgaTtcbiAgICBpdGVtLmxldmVsID0gbGV2ZWw7XG4gICAgY29tcHV0ZVJhbmtzQW5kTGV2ZWxzKGl0ZW0uY2hpbGRyZW4sIGxldmVscywgbGV2ZWwgKyAxKTtcbiAgfVxuICBsZXZlbHNbbGV2ZWxdID0gbWluUmFuayArIGNoaWxkcmVuLmxlbmd0aDtcbn1cbiIsIi8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovXG5pbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCJcblxuaW1wb3J0IHsgY3JlYXRlVHJlZVN0cnVjdHVyZSwgVHJlZUl0ZW0gfSBmcm9tIFwiLi90cmVlXCJcblxuaW1wb3J0IHsgTW9ycGhvbG9neSB9IGZyb20gXCJAL3NlcnZpY2VzL2JsdWVuYWFzLXNpbmdsZS1jZWxsL3R5cGVzXCJcblxuY29uc3QgTUFSR0lOID0gOFxuXG5pbnRlcmZhY2UgU2VnbWVudCB7XG4gICAgeDA6IG51bWJlclxuICAgIHkwOiBudW1iZXJcbiAgICB4MTogbnVtYmVyXG4gICAgeTE6IG51bWJlclxufVxuXG5jbGFzcyBQYWludGVyRGVuZHJvZ3JhbSB7XG4gICAgcHJpdmF0ZSBfbW9ycGhvbG9neTogTW9ycGhvbG9neSA9IHt9XG5cbiAgICBwcml2YXRlIGNvbnRleHQ6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCB8IG51bGwgPSBudWxsXG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IG9ic2VydmVyOiBSZXNpemVPYnNlcnZlclxuXG4gICAgcHJpdmF0ZSBwYWludGluZ1NjaGVkdWxlZCA9IGZhbHNlXG5cbiAgICBwcml2YXRlIHNlZ21lbnRzOiBSZWNvcmQ8c3RyaW5nLCBTZWdtZW50W10+ID0ge31cblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyID0gbmV3IFJlc2l6ZU9ic2VydmVyKHRoaXMucGFpbnQpXG4gICAgfVxuXG4gICAgZ2V0IG1vcnBob2xvZ3koKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb3JwaG9sb2d5XG4gICAgfVxuXG4gICAgc2V0IG1vcnBob2xvZ3kodmFsdWU6IE1vcnBob2xvZ3kpIHtcbiAgICAgICAgaWYgKHZhbHVlID09PSB0aGlzLl9tb3JwaG9sb2d5KSByZXR1cm5cblxuICAgICAgICB0aGlzLl9tb3JwaG9sb2d5ID0gdmFsdWVcbiAgICAgICAgdGhpcy51cGRhdGVNb3JwaG9sb2d5KClcbiAgICB9XG5cbiAgICByZWFkb25seSBpbml0ID0gKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQgfCBudWxsKSA9PiB7XG4gICAgICAgIGlmICghY2FudmFzKSByZXR1cm5cblxuICAgICAgICBjb25zdCBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKVxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0XG4gICAgICAgIHRoaXMub2JzZXJ2ZXIub2JzZXJ2ZShjYW52YXMpXG4gICAgICAgIHRoaXMudXBkYXRlTW9ycGhvbG9neSgpXG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZGVsZXRlXG4gICAgfVxuXG4gICAgcmVhZG9ubHkgcGFpbnQgPSAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLnBhaW50aW5nU2NoZWR1bGVkKSByZXR1cm5cblxuICAgICAgICB0aGlzLnBhaW50aW5nU2NoZWR1bGVkID0gdHJ1ZVxuICAgICAgICBnbG9iYWxUaGlzLnJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLmFjdHVhbFBhaW50KVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVhZG9ubHkgYWN0dWFsUGFpbnQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMucGFpbnRpbmdTY2hlZHVsZWQgPSBmYWxzZVxuICAgICAgICBjb25zdCB7IGNvbnRleHQgfSA9IHRoaXNcbiAgICAgICAgaWYgKCFjb250ZXh0KSByZXR1cm5cblxuICAgICAgICBjb25zdCB7IGNhbnZhcyB9ID0gY29udGV4dFxuICAgICAgICByZXNpemVDYW52YXMoY2FudmFzKVxuICAgICAgICBjb25zdCB7IHdpZHRoLCBoZWlnaHQgfSA9IGNhbnZhc1xuICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwiIzAwMFwiXG4gICAgICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcbiAgICAgICAgY29uc3QgeENvcm5lciA9IE1BUkdJTlxuICAgICAgICBjb25zdCB5Q29ybmVyID0gTUFSR0lOXG4gICAgICAgIGNvbnN0IHcgPSB3aWR0aCAtIDIgKiBNQVJHSU5cbiAgICAgICAgY29uc3QgaCA9IGhlaWdodCAtIDIgKiBNQVJHSU5cbiAgICAgICAgY29uc3QgZnggPSAoeDogbnVtYmVyKSA9PiAwLjUgKyBNYXRoLnJvdW5kKHhDb3JuZXIgKyB3ICogeClcbiAgICAgICAgY29uc3QgZnkgPSAoeTogbnVtYmVyKSA9PiAwLjUgKyBNYXRoLnJvdW5kKHlDb3JuZXIgKyBoICogeSlcbiAgICAgICAgY29udGV4dC5saW5lV2lkdGggPSAyXG4gICAgICAgIGZvciAoY29uc3QgY29sb3Igb2YgT2JqZWN0LmtleXModGhpcy5zZWdtZW50cykpIHtcbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlU3R5bGUgPSBjb2xvclxuICAgICAgICAgICAgY29udGV4dC5iZWdpblBhdGgoKVxuICAgICAgICAgICAgZm9yIChjb25zdCB7IHgwLCB5MCwgeDEsIHkxIH0gb2YgdGhpcy5zZWdtZW50c1tjb2xvcl0pIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0Lm1vdmVUbyhmeCh4MCksIGZ5KHkwKSlcbiAgICAgICAgICAgICAgICBjb250ZXh0LmxpbmVUbyhmeCh4MSksIGZ5KHkxKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRleHQuc3Ryb2tlKClcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdXBkYXRlTW9ycGhvbG9neSgpIHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0IH0gPSB0aGlzXG4gICAgICAgIGlmICghY29udGV4dCkgcmV0dXJuXG5cbiAgICAgICAgY29uc3QgdHJlZSA9IGNyZWF0ZVRyZWVTdHJ1Y3R1cmUodGhpcy5tb3JwaG9sb2d5KVxuICAgICAgICBjb25zb2xlLmxvZyhcIvCfkJ4gW3BhaW50ZXJAOTRdIHRyZWUgPVwiLCB0cmVlKSAvLyBARklYTUU6IFJlbW92ZSB0aGlzIGxpbmUgd3JpdHRlbiBvbiAyMDI1LTEyLTEyIGF0IDE3OjA3XG4gICAgICAgIGNvbnN0IHNlZ21lbnRzOiBSZWNvcmQ8c3RyaW5nLCBTZWdtZW50W10+ID0ge31cbiAgICAgICAgZmVlZFNlZ21lbnRzKHNlZ21lbnRzLCB0cmVlLmNoaWxkcmVuLCB0cmVlLmxldmVscylcbiAgICAgICAgY29uc29sZS5sb2coXCLwn5CeIFtwYWludGVyQDk3XSBzZWdtZW50cyA9XCIsIHNlZ21lbnRzKSAvLyBARklYTUU6IFJlbW92ZSB0aGlzIGxpbmUgd3JpdHRlbiBvbiAyMDI1LTEyLTEyIGF0IDE1OjMzXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSBzZWdtZW50c1xuICAgICAgICB0aGlzLnBhaW50KClcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlbGV0ZSA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyBjb250ZXh0IH0gPSB0aGlzXG4gICAgICAgIGlmICghY29udGV4dCkgcmV0dXJuXG5cbiAgICAgICAgdGhpcy5vYnNlcnZlci51bm9ic2VydmUoY29udGV4dC5jYW52YXMpXG4gICAgICAgIHRoaXMuY29udGV4dCA9IG51bGxcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQYWludGVyRGVuZHJvZ3JhbShtb3JwaG9sb2d5OiBNb3JwaG9sb2d5KSB7XG4gICAgY29uc3QgcmVmID0gUmVhY3QudXNlUmVmPFBhaW50ZXJEZW5kcm9ncmFtIHwgbnVsbD4obnVsbClcbiAgICBpZiAoIXJlZi5jdXJyZW50KSByZWYuY3VycmVudCA9IG5ldyBQYWludGVyRGVuZHJvZ3JhbSgpXG4gICAgUmVhY3QudXNlRWZmZWN0KCgpID0+IHtcbiAgICAgICAgY29uc3QgcGFpbnRlciA9IHJlZi5jdXJyZW50XG4gICAgICAgIGlmICghcGFpbnRlcikgcmV0dXJuXG5cbiAgICAgICAgcGFpbnRlci5tb3JwaG9sb2d5ID0gbW9ycGhvbG9neVxuICAgIH0sIFttb3JwaG9sb2d5XSlcbiAgICByZXR1cm4gcmVmLmN1cnJlbnRcbn1cblxuZnVuY3Rpb24gcmVzaXplQ2FudmFzKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICBpZiAoXG4gICAgICAgIGNhbnZhcy53aWR0aCAhPT0gY2FudmFzLmNsaWVudFdpZHRoIHx8XG4gICAgICAgIGNhbnZhcy5oZWlnaHQgIT09IGNhbnZhcy5jbGllbnRIZWlnaHRcbiAgICApIHtcbiAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLmNsaWVudFdpZHRoXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSBjYW52YXMuY2xpZW50SGVpZ2h0XG4gICAgfVxufVxuXG5mdW5jdGlvbiBmZWVkU2VnbWVudHMoXG4gICAgc2VnbWVudHM6IFJlY29yZDxzdHJpbmcsIFNlZ21lbnRbXT4sXG4gICAgY2hpbGRyZW46IFRyZWVJdGVtW10sXG4gICAgbGV2ZWxzOiBudW1iZXJbXVxuKSB7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGNoaWxkcmVuKSB7XG4gICAgICAgIGZlZWRTZWdtZW50cyhzZWdtZW50cywgaXRlbS5jaGlsZHJlbiwgbGV2ZWxzKVxuICAgICAgICBjb25zdCBjb2xvciA9IHJlc29sdmVDb2xvcihpdGVtLnNlY3Rpb24ubmFtZSlcbiAgICAgICAgY29uc3Qgc2VnbWVudHNPZlNhbWVDb2xvcjogU2VnbWVudFtdID0gZ2V0U2VnbWVudHNPZkNvbG9yKFxuICAgICAgICAgICAgc2VnbWVudHMsXG4gICAgICAgICAgICBjb2xvclxuICAgICAgICApXG4gICAgICAgIGZvciAoY29uc3QgeyByYW5rLCBsZXZlbCB9IG9mIGl0ZW0uY2hpbGRyZW4pIHtcbiAgICAgICAgICAgIGNvbnN0IHggPSAocmFuayArIDAuNSkgLyBsZXZlbHNbbGV2ZWxdXG4gICAgICAgICAgICBjb25zdCB5ID0gbGV2ZWwgLyBsZXZlbHMubGVuZ3RoXG4gICAgICAgICAgICBjb25zdCBoID0gMSAvIGxldmVscy5sZW5ndGhcbiAgICAgICAgICAgIHNlZ21lbnRzT2ZTYW1lQ29sb3IucHVzaCh7XG4gICAgICAgICAgICAgICAgeDA6IHgsXG4gICAgICAgICAgICAgICAgeTA6IHksXG4gICAgICAgICAgICAgICAgeDE6IHgsXG4gICAgICAgICAgICAgICAgeTE6IHkgKyBoLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoY2hpbGRyZW4ubGVuZ3RoID4gMSkge1xuICAgICAgICAvLyBIb3Jpem9udGFsIHNlZ21lbnRzXG4gICAgICAgIGNvbnN0IFtmaXJzdF0gPSBjaGlsZHJlblxuICAgICAgICBjb25zdCBsYXN0ID0gY2hpbGRyZW5bY2hpbGRyZW4ubGVuZ3RoIC0gMV1cbiAgICAgICAgY29uc3Qgc2VnbWVudHNIb3Jpem9udGFsID0gZ2V0U2VnbWVudHNPZkNvbG9yKFxuICAgICAgICAgICAgc2VnbWVudHMsXG4gICAgICAgICAgICByZXNvbHZlQ29sb3IoXCJob3Jpem9udGFsXCIpXG4gICAgICAgIClcbiAgICAgICAgY29uc3QgeDAgPSAoZmlyc3QucmFuayArIDAuNSkgLyBsZXZlbHNbZmlyc3QubGV2ZWxdXG4gICAgICAgIGNvbnN0IHgxID0gKGxhc3QucmFuayArIDAuNSkgLyBsZXZlbHNbbGFzdC5sZXZlbF1cbiAgICAgICAgY29uc3QgeSA9IGZpcnN0LmxldmVsIC8gbGV2ZWxzLmxlbmd0aFxuICAgICAgICBzZWdtZW50c0hvcml6b250YWwucHVzaCh7XG4gICAgICAgICAgICB4MCxcbiAgICAgICAgICAgIHkwOiB5LFxuICAgICAgICAgICAgeDEsXG4gICAgICAgICAgICB5MTogeSxcbiAgICAgICAgfSlcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlc29sdmVDb2xvcihuYW1lOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IHByZWZpeCA9IG5hbWUuc2xpY2UoMCwgNCkudG9Mb2NhbGVMb3dlckNhc2UoKVxuICAgIHN3aXRjaCAocHJlZml4KSB7XG4gICAgICAgIGNhc2UgXCJheG9uXCI6XG4gICAgICAgICAgICByZXR1cm4gXCIjMDdmXCJcbiAgICAgICAgY2FzZSBcImRlbmRcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiNGNTVcIlxuICAgICAgICBjYXNlIFwiYmFzYVwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiI0YzM1wiXG4gICAgICAgIGNhc2UgXCJhcGljXCI6XG4gICAgICAgICAgICByZXR1cm4gXCIjRjhmXCJcbiAgICAgICAgY2FzZSBcIm15ZWxcIjpcbiAgICAgICAgICAgIHJldHVybiBgIzc3OGBcbiAgICAgICAgY2FzZSBcInNvbWFcIjpcbiAgICAgICAgICAgIHJldHVybiBcIiNkZGVcIlxuICAgICAgICBjYXNlIFwiaG9yaXpvbnRhbFwiOlxuICAgICAgICAgICAgcmV0dXJuIFwiIzdmNzVcIlxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIFwiI2ZmZlwiXG4gICAgfVxufVxuXG5mdW5jdGlvbiBnZXRTZWdtZW50c09mQ29sb3IoXG4gICAgc2VnbWVudHM6IFJlY29yZDxzdHJpbmcsIFNlZ21lbnRbXT4sXG4gICAgY29sb3I6IHN0cmluZ1xuKTogU2VnbWVudFtdIHtcbiAgICBjb25zdCBpdGVtID0gc2VnbWVudHNbY29sb3JdXG4gICAgaWYgKGl0ZW0pIHJldHVybiBpdGVtXG5cbiAgICBjb25zdCBuZXdJdGVtOiBTZWdtZW50W10gPSBbXVxuICAgIHNlZ21lbnRzW2NvbG9yXSA9IG5ld0l0ZW1cbiAgICByZXR1cm4gbmV3SXRlbVxufVxuIiwiaW1wb3J0IHsgVGhlbWUgfSBmcm9tIFwiQHRvbG9rb2Jhbi91aVwiXG5cbmV4cG9ydCBmdW5jdGlvbiBjbGFzc05hbWVzKC4uLmFyZ3M6IHVua25vd25bXSk6IHN0cmluZyB7XG4gICAgcmV0dXJuIFRoZW1lLmNsYXNzTmFtZXMuam9pbiguLi5hcmdzKVxufVxuIiwiXG4gICAgICBpbXBvcnQgQVBJIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0eWxlLWxvYWRlckAzLjMuNF93ZWJwYWNrQDUuMTAyLjEvbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCI7XG4gICAgICBpbXBvcnQgZG9tQVBJIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0eWxlLWxvYWRlckAzLjMuNF93ZWJwYWNrQDUuMTAyLjEvbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVEb21BUEkuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRGbiBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHlsZS1sb2FkZXJAMy4zLjRfd2VicGFja0A1LjEwMi4xL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydEJ5U2VsZWN0b3IuanNcIjtcbiAgICAgIGltcG9ydCBzZXRBdHRyaWJ1dGVzIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0eWxlLWxvYWRlckAzLjMuNF93ZWJwYWNrQDUuMTAyLjEvbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc2V0QXR0cmlidXRlc1dpdGhvdXRBdHRyaWJ1dGVzLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0U3R5bGVFbGVtZW50IGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzLy5wbnBtL3N0eWxlLWxvYWRlckAzLjMuNF93ZWJwYWNrQDUuMTAyLjEvbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0U3R5bGVFbGVtZW50LmpzXCI7XG4gICAgICBpbXBvcnQgc3R5bGVUYWdUcmFuc2Zvcm1GbiBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy8ucG5wbS9zdHlsZS1sb2FkZXJAMy4zLjRfd2VicGFja0A1LjEwMi4xL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlVGFnVHJhbnNmb3JtLmpzXCI7XG4gICAgICBpbXBvcnQgY29udGVudCwgKiBhcyBuYW1lZEV4cG9ydCBmcm9tIFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3NzLWxvYWRlckA2LjExLjBfd2VicGFja0A1LjEwMi4xL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9ydWxlU2V0WzFdLnJ1bGVzWzZdLnVzZVsxXSEuL3ZpZXdlci1kZW5kcm9ncmFtLm1vZHVsZS5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvLnBucG0vY3NzLWxvYWRlckA2LjExLjBfd2VicGFja0A1LjEwMi4xL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzPz9ydWxlU2V0WzFdLnJ1bGVzWzZdLnVzZVsxXSEuL3ZpZXdlci1kZW5kcm9ncmFtLm1vZHVsZS5jc3NcIjtcbiAgICAgICBleHBvcnQgZGVmYXVsdCBjb250ZW50ICYmIGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB1bmRlZmluZWQ7XG4iLCJpbXBvcnQgUmVhY3QgZnJvbSBcInJlYWN0XCJcblxuaW1wb3J0IHsgdXNlUGFpbnRlckRlbmRyb2dyYW0gfSBmcm9tIFwiLi9wYWludGVyL3BhaW50ZXJcIlxuXG5pbXBvcnQgeyBjbGFzc05hbWVzIH0gZnJvbSBcIkAvdXRpbC91dGlsc1wiXG5pbXBvcnQgeyBNb3JwaG9sb2d5IH0gZnJvbSBcIkAvc2VydmljZXMvYmx1ZW5hYXMtc2luZ2xlLWNlbGwvdHlwZXNcIlxuXG5pbXBvcnQgc3R5bGVzIGZyb20gXCIuL3ZpZXdlci1kZW5kcm9ncmFtLm1vZHVsZS5jc3NcIlxuXG5leHBvcnQgaW50ZXJmYWNlIFZpZXdlckRlbmRyb2dyYW1Qcm9wcyB7XG4gICAgY2xhc3NOYW1lPzogc3RyaW5nXG4gICAgbW9ycGhvbG9neTogTW9ycGhvbG9neVxufVxuXG5leHBvcnQgZnVuY3Rpb24gVmlld2VyRGVuZHJvZ3JhbSh7XG4gICAgY2xhc3NOYW1lLFxuICAgIG1vcnBob2xvZ3ksXG59OiBWaWV3ZXJEZW5kcm9ncmFtUHJvcHMpIHtcbiAgICBjb25zdCBwYWludGVyID0gdXNlUGFpbnRlckRlbmRyb2dyYW0obW9ycGhvbG9neSlcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc05hbWVzKGNsYXNzTmFtZSwgc3R5bGVzLnZpZXdlckRlbmRyb2dyYW0pfT5cbiAgICAgICAgICAgIDxjYW52YXMgcmVmPXtwYWludGVyLmluaXR9IC8+XG4gICAgICAgIDwvZGl2PlxuICAgIClcbn1cbiIsImltcG9ydCB7IE1vcnBob2xvZ3kgfSBmcm9tIFwiQC9zZXJ2aWNlcy9ibHVlbmFhcy1zaW5nbGUtY2VsbC90eXBlc1wiXG5cbmV4cG9ydCBjb25zdCBtb3JwaG9sb2d5OiBNb3JwaG9sb2d5ID0gbWFrZU1vcnBob2xvZ3koKVxuXG5pbnRlcmZhY2UgVHJlZUl0ZW0ge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHg6IG51bWJlclxuICAgIHk6IG51bWJlclxuICAgIGNoaWxkcmVuOiBUcmVlSXRlbVtdXG59XG5cbmZ1bmN0aW9uIEkoaXRlbTogUGFydGlhbDxUcmVlSXRlbT4pOiBUcmVlSXRlbSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogXCJzb21hXCIsXG4gICAgICAgIHg6IDAsXG4gICAgICAgIHk6IDAsXG4gICAgICAgIGNoaWxkcmVuOiBbXSxcbiAgICAgICAgLi4uaXRlbSxcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1ha2VNb3JwaG9sb2d5KCk6IE1vcnBob2xvZ3kge1xuICAgIGNvbnN0IG1vcnBob2xvZ3k6IE1vcnBob2xvZ3kgPSB7fVxuICAgIGNvbnZlcnRUcmVlVG9Nb3JwaG9sb2d5KFxuICAgICAgICBbXG4gICAgICAgICAgICBJKHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgICAgICBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiZGVuZC4xXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEkoeyBuYW1lOiBcImRlbmQuMS4xXCIgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSSh7IG5hbWU6IFwiZGVuZC4xLjJcIiB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIF0sXG4gICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICBJKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiZGVuZC4yXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIEkoeyBuYW1lOiBcImRlbmQuMi4xXCIgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSSh7IG5hbWU6IFwiZGVuZC4yLjJcIiB9KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJKHsgbmFtZTogXCJkZW5kLjIuM1wiIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0pLFxuICAgICAgICBdLFxuICAgICAgICBtb3JwaG9sb2d5XG4gICAgKVxuICAgIHJldHVybiBtb3JwaG9sb2d5XG59XG5cbmZ1bmN0aW9uIGNvbnZlcnRUcmVlVG9Nb3JwaG9sb2d5KFxuICAgIHRyZWU6IFRyZWVJdGVtW10sXG4gICAgbW9ycGhvbG9neTogTW9ycGhvbG9neSxcbiAgICBsZXZlbCA9IDBcbikge1xuICAgIHNldFRyZWVDb29yZHModHJlZSlcbiAgICBnZW5lcmF0ZU1vcnBob2xvZ3kobW9ycGhvbG9neSwgdHJlZSlcbiAgICByZXR1cm4gbW9ycGhvbG9neVxufVxuXG5mdW5jdGlvbiBzZXRUcmVlQ29vcmRzKHRyZWU6IFRyZWVJdGVtW10sIHJhbmsgPSAwLCBsZXZlbCA9IDApOiBudW1iZXIge1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0cmVlKSB7XG4gICAgICAgIHJhbmsgKz0gc2V0VHJlZUNvb3JkcyhpdGVtLmNoaWxkcmVuLCBsZXZlbCArIDEpXG4gICAgICAgIGl0ZW0ueCA9IHJhbmsrK1xuICAgICAgICBpdGVtLnkgPSBsZXZlbFxuICAgIH1cbiAgICByZXR1cm4gcmFua1xufVxuXG5mdW5jdGlvbiBnZW5lcmF0ZU1vcnBob2xvZ3koXG4gICAgbW9ycGhvbG9neTogTW9ycGhvbG9neSxcbiAgICB0cmVlOiBUcmVlSXRlbVtdLFxuICAgIHBhcmVudDogVHJlZUl0ZW0gPSB7IG5hbWU6IFwiXCIsIGNoaWxkcmVuOiBbXSwgeDogMCwgeTogMCB9LFxuICAgIGlkID0gMFxuKSB7XG4gICAgZm9yIChjb25zdCBpdGVtIG9mIHRyZWUpIHtcbiAgICAgICAgY29uc3QgbmFtZSA9IGAke2l0ZW0ubmFtZX0vJHtpZCsrfWBcbiAgICAgICAgbW9ycGhvbG9neVtuYW1lXSA9IHtcbiAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICBuc2VnOiAxLFxuICAgICAgICAgICAgeHN0YXJ0OiBbcGFyZW50LnhdLFxuICAgICAgICAgICAgeXN0YXJ0OiBbcGFyZW50LnldLFxuICAgICAgICAgICAgenN0YXJ0OiBbMF0sXG4gICAgICAgICAgICB4ZW5kOiBbaXRlbS54XSxcbiAgICAgICAgICAgIHllbmQ6IFtpdGVtLnldLFxuICAgICAgICAgICAgemVuZDogWzBdLFxuICAgICAgICB9XG4gICAgICAgIGlkID0gZ2VuZXJhdGVNb3JwaG9sb2d5KG1vcnBob2xvZ3ksIGl0ZW0uY2hpbGRyZW4sIGl0ZW0sIGlkKVxuICAgIH1cbiAgICByZXR1cm4gaWRcbn1cbiIsImltcG9ydCB7IFZpZXdlckRlbmRyb2dyYW0gfSBmcm9tIFwiQC9jb21wb25lbnRzL3ZpZXdlci1kZW5kcm9ncmFtXCJcbmltcG9ydCB7IG1vcnBob2xvZ3kgfSBmcm9tIFwiLi9tb3JwaG9sb2d5XCJcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gUGFnZSgpIHtcbiAgICByZXR1cm4gPFZpZXdlckRlbmRyb2dyYW0gbW9ycGhvbG9neT17bW9ycGhvbG9neX0gLz5cbn1cbiJdLCJuYW1lcyI6WyJfX19DU1NfTE9BREVSX0VYUE9SVF9fXyIsInB1c2giLCJtb2R1bGUiLCJpZCIsImxvY2FscyIsImNyZWF0ZVRyZWVTdHJ1Y3R1cmUiLCJtb3JwaG9sb2d5IiwiY2hpbGRyZW4iLCJpdGVtcyIsIk1hcCIsInNlY3Rpb25OYW1lIiwiT2JqZWN0Iiwia2V5cyIsInNlY3Rpb24iLCJpIiwibnNlZyIsImtleUl0ZW0iLCJ4ZW5kIiwieWVuZCIsInplbmQiLCJrZXlQYXJlbnQiLCJ4c3RhcnQiLCJ5c3RhcnQiLCJ6c3RhcnQiLCJpdGVtIiwibGV2ZWwiLCJyYW5rIiwieCIsInkiLCJzZXQiLCJnZXQiLCJsZXZlbHMiLCJjb21wdXRlUmFua3NBbmRMZXZlbHMiLCJsZW5ndGgiLCJtaW5SYW5rIiwiUGFpbnRlckRlbmRyb2dyYW0iLCJjb25zdHJ1Y3RvciIsIl9tb3JwaG9sb2d5IiwiY29udGV4dCIsInBhaW50aW5nU2NoZWR1bGVkIiwic2VnbWVudHMiLCJpbml0IiwiY2FudmFzIiwiZ2V0Q29udGV4dCIsInRoaXMiLCJvYnNlcnZlciIsIm9ic2VydmUiLCJ1cGRhdGVNb3JwaG9sb2d5IiwiZGVsZXRlIiwicGFpbnQiLCJnbG9iYWxUaGlzIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiYWN0dWFsUGFpbnQiLCJ3aWR0aCIsImNsaWVudFdpZHRoIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwicmVzaXplQ2FudmFzIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJ3IiwiaCIsImZ4IiwiTWF0aCIsInJvdW5kIiwiZnkiLCJsaW5lV2lkdGgiLCJjb2xvciIsInN0cm9rZVN0eWxlIiwiYmVnaW5QYXRoIiwieDAiLCJ5MCIsIngxIiwieTEiLCJtb3ZlVG8iLCJsaW5lVG8iLCJzdHJva2UiLCJ1bm9ic2VydmUiLCJSZXNpemVPYnNlcnZlciIsInZhbHVlIiwidHJlZSIsImNvbnNvbGUiLCJsb2ciLCJmZWVkU2VnbWVudHMiLCJzZWdtZW50c09mU2FtZUNvbG9yIiwiZ2V0U2VnbWVudHNPZkNvbG9yIiwicmVzb2x2ZUNvbG9yIiwibmFtZSIsImZpcnN0IiwibGFzdCIsInNlZ21lbnRzSG9yaXpvbnRhbCIsInNsaWNlIiwidG9Mb2NhbGVMb3dlckNhc2UiLCJuZXdJdGVtIiwiY2xhc3NOYW1lcyIsImFyZ3MiLCJqb2luIiwib3B0aW9ucyIsInN0eWxlVGFnVHJhbnNmb3JtIiwic2V0QXR0cmlidXRlcyIsImluc2VydCIsImRvbUFQSSIsImluc2VydFN0eWxlRWxlbWVudCIsInVuZGVmaW5lZCIsIlZpZXdlckRlbmRyb2dyYW0iLCJjbGFzc05hbWUiLCJwYWludGVyIiwicmVmIiwiY3VycmVudCIsInVzZVBhaW50ZXJEZW5kcm9ncmFtIiwidmlld2VyRGVuZHJvZ3JhbSIsInNldFRyZWVDb29yZHMiLCJnZW5lcmF0ZU1vcnBob2xvZ3kiLCJjb252ZXJ0VHJlZVRvTW9ycGhvbG9neSIsIkkiLCJtYWtlTW9ycGhvbG9neSIsInBhcmVudCIsIlBhZ2UiXSwic291cmNlUm9vdCI6IiJ9